<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="google-site-verification" content="FPWHdyBDD6jevLuW5oFDPqoeCkmXxYTpLezJ_qISKeE" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Code help, tutorials, guides, tips">
    <meta name="keywords"  content="code base camp codebase camp basecamp programming tutorial help guides iOS xCode Swift Android Java">
    <meta name="theme-color" content="#000000">

    <title>Getting a Perfect 100/100 Google PageSpeed Score with an S3 Static Website - Coding Guides, Tutorials and Help | CodeBaseCamp</title>

    <!-- Web App Manifest -->
    <link rel="manifest" href="/pwa/manifest.json">

    <!-- Favicon -->
    <link rel="apple-touch-icon-precomposed" sizes="57x57" href="../img/favicon/apple-touch-icon-57x57.png" />
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="../img/favicon/apple-touch-icon-114x114.png" />
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="../img/favicon/apple-touch-icon-72x72.png" />
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="../img/favicon/apple-touch-icon-144x144.png" />
    <link rel="apple-touch-icon-precomposed" sizes="60x60" href="../img/favicon/apple-touch-icon-60x60.png" />
    <link rel="apple-touch-icon-precomposed" sizes="120x120" href="../img/favicon/apple-touch-icon-120x120.png" />
    <link rel="apple-touch-icon-precomposed" sizes="76x76" href="../img/favicon/apple-touch-icon-76x76.png" />
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../img/favicon/apple-touch-icon-152x152.png" />
    <link rel="icon" type="image/png" href="../img/favicon/favicon-196x196.png" sizes="196x196" />
    <link rel="icon" type="image/png" href="../img/favicon/favicon-96x96.png" sizes="96x96" />
    <link rel="icon" type="image/png" href="../img/favicon/favicon-32x32.png" sizes="32x32" />
    <link rel="icon" type="image/png" href="../img/favicon/favicon-16x16.png" sizes="16x16" />
    <link rel="icon" type="image/png" href="../img/favicon/favicon-128.png" sizes="128x128" />
    <meta name="application-name" content="CodeBaseCamp"/>
    <meta name="msapplication-TileColor" content="#FFFFFF" />
    <meta name="msapplication-TileImage" content="../img/favicon/mstile-144x144.png" />
    <meta name="msapplication-square70x70logo" content="../img/favicon/mstile-70x70.png" />
    <meta name="msapplication-square150x150logo" content="../img/favicon/mstile-150x150.png" />
    <meta name="msapplication-wide310x150logo" content="../img/favicon/mstile-310x150.png" />
    <meta name="msapplication-square310x310logo" content="../img/favicon/mstile-310x310.png" />


    <!-- Canonical URL -->
    <link rel="canonical" href="http://localhost:4000/2017/10/03/Perfect-PageSpeed/">

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="/css/bootstrap.min.css">

    <!-- Custom CSS -->
    <!-- <link rel="stylesheet" href="/css/hux-blog.min.css"> -->
    <link rel="stylesheet" href="/css/hux-blog.css">

    <!-- Pygments Github CSS -->
    <link rel="stylesheet" href="/css/syntax.css">

    <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,600,700,800" rel="stylesheet">

    <!-- Custom Fonts -->
    <!-- <link href="http://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css"> -->
    <!-- Hux change font-awesome CDN to qiniu -->
    <link href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css">

    <!-- Hux Delete, sad but pending in China
    <link href='http://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/
    css'>
    -->


    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- ga & ba script hoook -->
    <script></script>
</head>


<!-- hack iOS CSS :active style -->
<body ontouchstart="">

    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">Code Base Camp</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div id="huxblog_navbar">
            <div class="navbar-collapse">
                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="/">Home</a>
                    </li>
                    
                    <li>
                        <a href="/about/">About</a>
                    </li>
                    
                    <li>
                        <a href="/tags/">Tags</a>
                    </li>
                    
                </ul>
            </div>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>
<script>
    // Drop Bootstarp low-performance Navbar
    // Use customize navbar with high-quality material design animation
    // in high-perf jank-free CSS3 implementation
    var $body   = document.body;
    var $toggle = document.querySelector('.navbar-toggle');
    var $navbar = document.querySelector('#huxblog_navbar');
    var $collapse = document.querySelector('.navbar-collapse');

    var __HuxNav__ = {
        close: function(){
            $navbar.className = " ";
            // wait until animation end.
            setTimeout(function(){
                // prevent frequently toggle
                if($navbar.className.indexOf('in') < 0) {
                    $collapse.style.height = "0px"
                }
            },400)
        },
        open: function(){
            $collapse.style.height = "auto"
            $navbar.className += " in";
        }
    }

    // Bind Event
    $toggle.addEventListener('click', function(e){
        if ($navbar.className.indexOf('in') > 0) {
            __HuxNav__.close()
        }else{
            __HuxNav__.open()
        }
    })

    /**
     * Since Fastclick is used to delegate 'touchstart' globally
     * to hack 300ms delay in iOS by performing a fake 'click',
     * Using 'e.stopPropagation' to stop 'touchstart' event from 
     * $toggle/$collapse will break global delegation.
     * 
     * Instead, we use a 'e.target' filter to prevent handler
     * added to document close HuxNav.  
     *
     * Also, we use 'click' instead of 'touchstart' as compromise
     */
    document.addEventListener('click', function(e){
        if(e.target == $toggle) return;
        if(e.target.className == 'icon-bar') return;
        __HuxNav__.close();
    })
</script>


    <!-- Image to hack wechat -->
<!-- <img src="/img/icon_wechat.png" width="0" height="0"> -->
<!-- <img src="/img/2017-10-03_cover.png" width="0" height="0"> -->

<!-- Post Header -->
<style type="text/css">
    header.intro-header{
        position: relative;
        background-image: url('/img/2017-10-03_cover.png')
    }

    
    header.intro-header .header-mask{
        width: 100%;
        height: 100%;
        position: absolute;
        background: rgba(0,0,0, 0.5);
    }
    
</style>
<header class="intro-header" >
    <div class="header-mask"></div>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <div class="tags">
                        
                        <a class="tag" href="/tags/#Web" title="Web">Web</a>
                        
                        <a class="tag" href="/tags/#SEO" title="SEO">SEO</a>
                        
                        <a class="tag" href="/tags/#Optimisation" title="Optimisation">Optimisation</a>
                        
                    </div>
                    <h1>Getting a Perfect 100/100 Google PageSpeed Score with an S3 Static Website</h1>
                    
                    
                    <h2 class="subheading">How to Spaghettify your Website beyond Recognition</h2>
                    
                    <span class="meta">Posted by Tom on October 3, 2017</span>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">

    <!-- Post Container -->
            <div class="
                col-lg-8
                col-md-10 col-md-offset-1
                post-container">

				<p><img src="https://imgur.com/J9CY0dl.png" alt="Perfect PageSpeed" /></p>

<p><a href="https://developers.google.com/speed/pagespeed/insights/">Google PageSpeed</a> is a tool for testing the performance of websites for mobile and desktop, and plays some part in how Google’s algorithms rank your website. Page speed isn’t everything but I got obsessed with the idea of achieving a perfect 100/100 score for both mobile and desktop, so I set out to achieve it on a small landing page for one of my mobile apps.</p>

<p>I’ll be tailoring this guide to websites hosted on <a href="https://aws.amazon.com/s3">Amazon Web Services S3</a> and <a href="https://aws.amazon.com/cloudfront">Cloudfront</a>. If you’re unfamiliar with this hosting method I highly recommend checking out <a href="https://medium.com/@esfoobar/setting-up-an-https-static-site-using-amazon-aws-7ab270c4e277">Jorge Escobar’s guide here</a> which covers hosting on S3, distributing through the Cloudfront CDN and setting up SSL/TLS/HTTPS. Hosting a static site on S3 can be very cost-effective; hosting multiple sites for &lt; $5 month is not unusual. With Amazon’s free-tier it may even be free for you.</p>

<p>After you’ve set up your website through S3, go to <a href="https://developers.google.com/speed/pagespeed/insights/">PageSpeed Insights</a>, input your website and hit analyze.</p>

<p><img src="https://imgur.com/AgWfqx5.png" alt="Youtube's PageSpeed Score" /></p>

<p><em>Yes, that’s youtube with a score of 46 for mobile and 76 for desktop. Funnily enough, Vimeo gets 93 mobile / 80 desktop. I hear another <a href="https://www.theverge.com/2017/6/27/15872354/google-eu-fine-antitrust-shopping">anti-trust fine</a> a’brewin</em></p>

<p>Rather helpfully PageSpeed provides insights into how to improve your website’s score. I’ll break down each of the Possible Optimisations below into seperate sections with advice on how to fix them for an S3-hosted website.</p>

<h2 id="optimise-images">Optimise Images</h2>

<p><img src="https://imgur.com/clbcCHU.png" alt="Optimised Images" /></p>

<p>This is one of the easiest things to fix and should give one of the biggest boosts in both performance and PageSpeed score. PageSpeed automatically compresses and resizes your images for you and provides a download link at the bottom. Click the link, download the images and replace your websites images with Google’s optimised versions.</p>

<h2 id="minify-javascripthtmlcss">Minify Javascript/HTML/CSS</h2>

<p>Minification removes unneccessary whitespace and characters to make the overall filesize smaller. This is also pretty easy to fix, you can use the optimised versions provided by google, the same as with the images, or you can use a tool like <a href="https://gulpjs.com">Gulp</a> or even an in-browser tool like <a href="http://www.minifier.org">minifier.org</a>. Replace your files with the minified versions and the warning should disappear.</p>

<p><img src="https://imgur.com/N1s04CN.png" alt="Minification" /></p>

<h2 id="avoid-landing-page-redirects">Avoid Landing Page Redirects</h2>

<p>If you’re receiving this issue on an S3 site make sure you have your DNS set up correctly (Route53 if you used the guide mentioned earlier). Your domain name should point to your Cloudfront Distribution, which should point to your S3 bucket. Here’s a screenshot of my configuration:</p>

<p><strong>Route53 Setup</strong></p>

<p><img src="https://imgur.com/hMljEl4.png" alt="Route53 Setup" /></p>

<p><strong>Cloudfront Setup</strong></p>

<p><img src="https://imgur.com/BY8YgFx.png" alt="Cloudfront Setup" /></p>

<p><strong>S3 Setup</strong></p>

<p><img src="https://imgur.com/s1wooI0.png" alt="S3 Setup" /></p>

<h2 id="leverage-browser-caching">Leverage Browser Caching</h2>

<p>Another slightly more difficult configuration is setting up caching. This enables client-side caching so that resources are stored by a user’s browser for a duration.</p>

<p>There are two ways you can set this up: on the S3 Console or via the S3 upload command.</p>

<p>To change this on the console, select all items in your website’s S3 bucket, click ‘More’ &gt; ‘Change metadata’.</p>

<p><img src="https://imgur.com/9JmqVhV.png" alt="Select all bucket items" /></p>

<p>Add a new item with key ‘Cache-Control’. Set the value to ‘max-age:[seconds]’. This is the how long the item will be cached client-side before expiring, and a new copy is downloaded by the client. This needs to be a big number, if you set something like 2 hours then Google PageSpeed will still nag you. In the example I’ve set it to 2 years (63072000 seconds) which supresses these warnings.</p>

<p><img src="https://imgur.com/yZ7lQGo.png" alt="Add Cache-Control" /></p>

<p>The second way to do this via the S3 upload command with the <code class="highlighter-rouge">--cache-control</code> option. Here’s an example:</p>

<div class="language-sh highlighter-rouge"><pre class="highlight"><code>aws s3 cp --recursive index.html s3://ansavoicemail.com/ <span class="se">\</span>
    --grants <span class="nb">read</span><span class="o">=</span><span class="nv">uri</span><span class="o">=</span>http://acs.amazonaws.com/groups/global/AllUsers <span class="se">\ </span>
    --cache-control max-age<span class="o">=</span>63072000
</code></pre>
</div>

<hr />

<p>Remember to invalidate the Cloudfront cache after you make changes to your S3 bucket, so that these changes are propogated to the edge-servers, otherwise Cloudfront will be serving the old version of your files. There are better ways to do this but if you want to quickly refresh all files, go to Cloudfront, select your distribution, go to the <code class="highlighter-rouge">Invalidations</code> tab, click <code class="highlighter-rouge">Create Invalidation</code>. In the <code class="highlighter-rouge">Object Paths</code> box put <code class="highlighter-rouge">*</code>. Click <code class="highlighter-rouge">Invalidate</code>.</p>

<p><img src="https://imgur.com/oxME6iM.png" alt="Invalidating Cloudfront Cache" /></p>

<h2 id="eliminate-render-blocking-javascript-and-css-in-above-the-fold-content">Eliminate render-blocking JavaScript and CSS in above-the-fold Content</h2>

<p>This is perhaps the most difficult optimisation as its highly dependent on your websites layout and content. This warning occurs because your website is loading external resources above-the-fold (the top-section of your website that is visible when it loads). For example you may be loading bootstrap or ajax from their respective CDNs, which is slowing down your rendering.</p>

<p>Firstly try to remove any unused external resources, or move them locally into your s3 bucket if possible. If you’re using bootstrap or another framework, you’re probably only using a fraction of the CSS it provides. You can try to extract only the CSS selectors that are being utilised. Check out <a href="https://chrome.google.com/webstore/detail/css-used/cdopjfddjlonogibjahpnmjpoangjfff?hl=en">CSS Used for Google Chrome</a> Run it on your site, copy the CSS it gives you, run it through a CSS minifier and save it. If you only have a small amount of CSS you can include it in-line on your site. In the <code class="highlighter-rouge">&lt;head&gt;</code> section of your site add the minified css between <code class="highlighter-rouge">&lt;style&gt;</code> tags:</p>

<div class="language-css highlighter-rouge"><pre class="highlight"><code><span class="o">&lt;</span><span class="nt">style</span><span class="o">&gt;</span>
<span class="nc">.nav</span><span class="p">{</span><span class="nl">margin-top</span><span class="p">:</span><span class="m">2rem</span><span class="p">;</span><span class="nl">margin-bottom</span><span class="p">:</span><span class="m">2rem</span><span class="p">}</span>
<span class="o">...</span>
<span class="o">&lt;/</span><span class="nt">style</span><span class="o">&gt;</span>
</code></pre>
</div>

<p>A common pitfall of this step is Google Analytics which throws the ‘Eliminate render-blocking…’ warning. To remedy this, download Google Analytics from https://www.google-analytics.com/analytics.js and store it with your site in S3. I also found that this script was re-downloading analytics.js from Google, so CTRL+F in analytics.js and replace any references to the above URL with your local file:</p>

<div class="language-sh highlighter-rouge"><pre class="highlight"><code>https://www.google-analytics.com/analytics.js
replace with e.g. -&gt;
js/analytics.js
</code></pre>
</div>

<p>You may also have a Google Tag Manager script, something like this:</p>

<div class="language-html highlighter-rouge"><pre class="highlight"><code><span class="nt">&lt;script </span><span class="na">async</span> <span class="na">src=</span><span class="s">'https://www.googletagmanager.com/gtag/js?id=UA-01234567-1'</span><span class="nt">&gt;</span><span class="err">
</span></code></pre>
</div>

<p>Go to the URL, download the script, save it locally. Run CTRL+F again and replace any references to <code class="highlighter-rouge">https://www.google-analytics.com/analytics.js</code> with your local copy.</p>

<h2 id="enable-compression">Enable Compression</h2>

<p>As S3 isn’t a normal webserver it wastes no processing power in gzip compressing files for you, so you need to do this manually before you upload them.</p>

<p>You should only compress html, css and javascript files with gzip. To do this on Mac and Linux run gzip -9 and then the filename:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>gzip -9 -k -f *.html
gzip -9 -k -f *.js
gzip -9 -k -f *.css
</code></pre>
</div>
<p><code class="highlighter-rouge">-9</code> is for maximum level of compression, <code class="highlighter-rouge">-k</code> keeps the original file, <code class="highlighter-rouge">-f</code> is force, so we replace our previous compression without the ‘are you sure…’ prompt.</p>

<p>If you compress <code class="highlighter-rouge">index.html</code> you should get <code class="highlighter-rouge">index.html.gz</code> out. We need to upload these compressed files to S3 with the compression type included in the metadata, so that the client knows to decompress the files before showing them in the browser.</p>

<p>You can add the compression metadata through the S3 console or with the upload command. The command below shows how you might do this with the <code class="highlighter-rouge">--content-encoding</code> option:</p>

<div class="language-sh highlighter-rouge"><pre class="highlight"><code>aws s3 cp --recursive index.html s3://ansavoicemail.com/ --grants <span class="nb">read</span><span class="o">=</span><span class="nv">uri</span><span class="o">=</span>http://acs.amazonaws.com/groups/global/AllUsers --cache-control max-age<span class="o">=</span>63072000 --content-encoding gzip
</code></pre>
</div>

<p>Alternatively, in the S3 console, select your compressed files, go to ‘More’ &gt; ‘Change metadata’. Add a new key called ‘Content-Encoding’ with the value ‘gzip’:</p>

<p><img src="https://imgur.com/vXUE5Dd.png" alt="Content Encoding Metadata" /></p>

<p><strong>NOTE:</strong> Don’t forget to change any references in your html files to the compressed files. For exaple if you’re loading in your JavaScript with <code class="highlighter-rouge">src="css/myscript.min.js"</code>, compress your JavaScript then change the reference to <code class="highlighter-rouge">src="js/myscript.min.css.gz"</code>. Alternatively rename your compressed files to remove the <code class="highlighter-rouge">.gz</code> extension, then you’ll have less problems during development.</p>

<h2 id="reduce-server-response-time">Reduce Server Response Time</h2>

<p>I received this warning while I was making the previous optimisations. Once i’d removed all the other warnings this one dissapeared too. As its hosted on S3 with Amazon’s CDN you’re pretty cutting-edge in terms of deployment. If that doesn’t cut it then you need a consultant, not a tutorial.</p>

<p>You might want to try reduce the size of your content. 100MB of optimised images is still 100MB of images; try to defer rendering until the above-the-fold content is rendered or implement some sort of splash-screen to make the site appear to render quicker.</p>

<h2 id="conclusion">Conclusion</h2>

<p>Hopefully these optimisations have improved the speed of your S3 static site to that perfect 100, or as close as you can get. PageSpeed is only a part of SEO and is not worth obsessing over. Getting a perfect 100 involves a lot spaghettification that can cause headaches if you need to make frequent updates. Downloading scripts like Google Analytics to your own server means that you won’t be up-to-date if it changes, unless you set up some additional automation. Unless your website is cripplingly slow, users probably won’t even notice your fine-tuning, but it should help bring in a few new users through search engines.</p>

<p>—— Tom 2017.10</p>


                <hr style="visibility: hidden;">

                


                <ul class="pager">
                    
                    <li class="previous">
                        <a href="/2017/09/20/Icon-Template/" data-toggle="tooltip" data-placement="top" title="iOS 11 and Android 8.0 Oreo App Icon Design Template">
                        Previous<br>
                        <span>iOS 11 and Android 8.0 Oreo App Icon Design Template</span>
                        </a>
                    </li>
                    
                    
                    <li class="next">
                        <a href="/2017/12/27/RxJava-UIThread/" data-toggle="tooltip" data-placement="top" title="RxJava 1.x - How to Observe on the Main UI Thread">
                        Next<br>
                        <span>RxJava 1.x - How to Observe on the Main UI Thread</span>
                        </a>
                    </li>
                    
                </ul>


                

                
                <!-- disqus 评论框 start -->
                <div class="comment">
                    <div id="disqus_thread" class="disqus-thread"></div>
                </div>
                <!-- disqus 评论框 end -->
                

            </div>

    

    <!-- Side Catalog Container -->
        
            <div class="
                col-lg-2 col-lg-offset-0
                visible-lg-block
                sidebar-container
                catalog-container">
                <div class="side-catalog">
                    <hr class="hidden-sm hidden-xs">
                    <h5>
                        <a class="catalog-toggle" href="#">SECTION</a>
                    </h5>
                    <ul class="catalog-body"></ul>
                </div>
            </div>
        

    <!-- Sidebar Container -->
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                sidebar-container">

                <!-- Featured Tags -->
                
                <section>
                    <hr class="hidden-sm hidden-xs">
                    <h5><a href="/tags/">FEATURED TAGS</a></h5>
                    <div class="tags">
        				
                            
                				<a href="/tags/#iOS" title="iOS" rel="2">
                                    iOS
                                </a>
                            
        				
                            
        				
                            
                				<a href="/tags/#Javascript" title="Javascript" rel="2">
                                    Javascript
                                </a>
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
                				<a href="/tags/#Web" title="Web" rel="2">
                                    Web
                                </a>
                            
        				
                            
        				
                            
                				<a href="/tags/#Go" title="Go" rel="2">
                                    Go
                                </a>
                            
        				
                            
                				<a href="/tags/#shell" title="shell" rel="2">
                                    shell
                                </a>
                            
        				
                            
                				<a href="/tags/#Project Management" title="Project Management" rel="2">
                                    Project Management
                                </a>
                            
        				
                            
        				
                            
                				<a href="/tags/#Android" title="Android" rel="2">
                                    Android
                                </a>
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
        			</div>
                </section>
                

                <!-- Friends Blog -->
                
                <hr>
                <h5>FRIENDS</h5>
                <ul class="list-inline">
                    
                        <li><a href="http://www.hypnosstudios.com/">Hypnos Studios</a></li>
                    
                </ul>
                
            </div>
        </div>
    </div>
</article>






<!-- disqus 公共JS代码 start (一个网页只需插入一次) -->
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES * * */
    var disqus_shortname = "code-base-camp";
    var disqus_identifier = "/2017/10/03/Perfect-PageSpeed";
    var disqus_url = "http://localhost:4000/2017/10/03/Perfect-PageSpeed/";

    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<!-- disqus 公共JS代码 end -->




<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>
<!-- anchor-js, Doc:http://bryanbraun.github.io/anchorjs/ -->
<script>
    async("//cdnjs.cloudflare.com/ajax/libs/anchor-js/1.1.1/anchor.min.js",function(){
        anchors.options = {
          visible: 'always',
          placement: 'right',
          icon: '#'
        };
        anchors.add().remove('.intro-header h1').remove('.subheading').remove('.sidebar-container h5');
    })
</script>
<style>
    /* place left on bigger screen */
    @media all and (min-width: 800px) {
        .anchorjs-link{
            position: absolute;
            left: -0.75em;
            font-size: 1.1em;
            margin-top : -0.1em;
        }
    }
</style>



    <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                    
                    

                    <!-- add Weibo, Zhihu by Hux, add target = "_blank" to <a> by Hux -->
                    
                    


                    
                    
                    <li>
                        <a target="_blank" href="https://github.com/tjw0051">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                </ul>
                <p class="copyright text-muted">
                    Copyright &copy; Code Base Camp 2018
                    <br>
                    Theme by <a href="http://huangxuan.me">Hux</a> |
                    <iframe
                        style="margin-left: 2px; margin-bottom:-5px;"
                        frameborder="0" scrolling="0" width="91px" height="20px"
                        src="https://ghbtns.com/github-btn.html?user=huxpro&repo=huxpro.github.io&type=star&count=true" >
                    </iframe>
                </p>
            </div>
        </div>
    </div>
</footer>

<!-- jQuery -->
<script src="/js/jquery.min.js "></script>

<!-- Bootstrap Core JavaScript -->
<script src="/js/bootstrap.min.js "></script>

<!-- Custom Theme JavaScript -->
<script src="/js/hux-blog.min.js "></script>

<!-- Service Worker -->

<script type="text/javascript">
    if(navigator.serviceWorker){
        // For security reasons, a service worker can only control the pages that are in the same directory level or below it. That's why we put sw.js at ROOT level.
        navigator.serviceWorker
            .register('/sw.js')
            .then((registration) => {console.log('Service Worker Registered. ', registration)})
            .catch((error) => {console.log('ServiceWorker registration failed: ', error)})
    }
</script>



<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>

<!-- 
     Because of the native support for backtick-style fenced code blocks 
     right within the Markdown is landed in Github Pages, 
     From V1.6, There is no need for Highlight.js, 
     so Huxblog drops it officially.

     - https://github.com/blog/2100-github-pages-now-faster-and-simpler-with-jekyll-3-0  
     - https://help.github.com/articles/creating-and-highlighting-code-blocks/ 
     - https://github.com/jneen/rouge/wiki/list-of-supported-languages-and-lexers   
-->
<!--
    <script>
        async("http://cdn.bootcss.com/highlight.js/8.6/highlight.min.js", function(){
            hljs.initHighlightingOnLoad();
        })
    </script>
    <link href="http://cdn.bootcss.com/highlight.js/8.6/styles/github.min.css" rel="stylesheet">
-->


<!-- jquery.tagcloud.js -->
<script>
    // only load tagcloud.js in tag.html
    if($('#tag_cloud').length !== 0){
        async('/js/jquery.tagcloud.js',function(){
            $.fn.tagcloud.defaults = {
                //size: {start: 1, end: 1, unit: 'em'},
                color: {start: '#bbbbee', end: '#0085a1'},
            };
            $('#tag_cloud a').tagcloud();
        })
    }
</script>

<!--fastClick.js -->
<script>
    async("//cdnjs.cloudflare.com/ajax/libs/fastclick/1.0.6/fastclick.min.js", function(){
        var $nav = document.querySelector("nav");
        if($nav) FastClick.attach($nav);
    })
</script>


<!-- Google Analytics -->

<script>
    // dynamic User by Hux
    var _gaId = 'UA-86516015-1';
    var _gaDomain = 'codebasecamp.com';

    // Originial
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', _gaId, _gaDomain);
    ga('send', 'pageview');
</script>



<!-- Baidu Tongji -->




<!-- Side Catalog -->

<script type="text/javascript">
    function generateCatalog (selector) {
        var P = $('div.post-container'),a,n,t,l,i,c;
        a = P.find('h1,h2,h3,h4,h5,h6');
        a.each(function () {
            n = $(this).prop('tagName').toLowerCase();
            i = "#"+$(this).prop('id');
            t = $(this).text();
            c = $('<a href="'+i+'" rel="nofollow">'+t+'</a>');
            l = $('<li class="'+n+'_nav"></li>').append(c);
            $(selector).append(l);
        });
        return true;    
    }

    generateCatalog(".catalog-body");

    // toggle side catalog
    $(".catalog-toggle").click((function(e){
        e.preventDefault();
        $('.side-catalog').toggleClass("fold")
    }))

    /*
     * Doc: https://github.com/davist11/jQuery-One-Page-Nav
     * Fork by Hux to support padding
     */
    async("/js/jquery.nav.js", function () {
        $('.catalog-body').onePageNav({
            currentClass: "active",
            changeHash: !1,
            easing: "swing",
            filter: "",
            scrollSpeed: 700,
            scrollOffset: 0,
            scrollThreshold: .2,
            begin: null,
            end: null,
            scrollChange: null,
            padding: 80
        });
    });
</script>





<!-- Image to hack wechat -->
<img src="/img/icon_wechat.png" width="0" height="0" />
<!-- Migrate from head to bottom, no longer block render and still work -->

</body>

</html>
